/*! For license information please see taskpane.js.LICENSE.txt */
!function(){function n(){var t,o,a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",l=a.toStringTag||"@@toStringTag";function r(n,a,i,l){var r=a&&a.prototype instanceof c?a:c,d=Object.create(r.prototype);return e(d,"_invoke",function(n,e,a){var i,l,r,c=0,d=a||[],u=!1,p={p:0,n:0,v:t,a:m,f:m.bind(t,4),d:function(n,e){return i=n,l=0,r=t,p.n=e,s}};function m(n,e){for(l=n,r=e,o=0;!u&&c&&!a&&o<d.length;o++){var a,i=d[o],m=p.p,v=i[2];n>3?(a=v===e)&&(r=i[(l=i[4])?5:(l=3,3)],i[4]=i[5]=t):i[0]<=m&&((a=n<2&&m<i[1])?(l=0,p.v=e,p.n=i[1]):m<v&&(a=n<3||i[0]>e||e>v)&&(i[4]=n,i[5]=e,p.n=v,l=0))}if(a||n>1)return s;throw u=!0,e}return function(a,d,v){if(c>1)throw TypeError("Generator is already running");for(u&&1===d&&m(d,v),l=d,r=v;(o=l<2?t:r)||!u;){i||(l?l<3?(l>1&&(p.n=-1),m(l,r)):p.n=r:p.v=r);try{if(c=2,i){if(l||(a="next"),o=i[a]){if(!(o=o.call(i,r)))throw TypeError("iterator result is not an object");if(!o.done)return o;r=o.value,l<2&&(l=0)}else 1===l&&(o=i.return)&&o.call(i),l<2&&(r=TypeError("The iterator does not provide a '"+a+"' method"),l=1);i=t}else if((o=(u=p.n<0)?r:n.call(e,p))!==s)break}catch(n){i=t,l=1,r=n}finally{c=1}}return{value:o,done:u}}}(n,i,l),!0),d}var s={};function c(){}function d(){}function u(){}o=Object.getPrototypeOf;var p=[][i]?o(o([][i]())):(e(o={},i,function(){return this}),o),m=u.prototype=c.prototype=Object.create(p);function v(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,u):(n.__proto__=u,e(n,l,"GeneratorFunction")),n.prototype=Object.create(m),n}return d.prototype=u,e(m,"constructor",u),e(u,"constructor",d),d.displayName="GeneratorFunction",e(u,l,"GeneratorFunction"),e(m),e(m,l,"Generator"),e(m,i,function(){return this}),e(m,"toString",function(){return"[object Generator]"}),(n=function(){return{w:r,m:v}})()}function e(n,t,o,a){var i=Object.defineProperty;try{i({},"",{})}catch(n){i=0}e=function(n,t,o,a){function l(t,o){e(n,t,function(n){return this._invoke(t,o,n)})}t?i?i(n,t,{value:o,enumerable:!a,configurable:!a,writable:!a}):n[t]=o:(l("next",0),l("throw",1),l("return",2))},e(n,t,o,a)}function t(n,e,t,o,a,i,l){try{var r=n[i](l),s=r.value}catch(n){return void t(n)}r.done?e(s):Promise.resolve(s).then(o,a)}function o(n){return function(){var e=this,o=arguments;return new Promise(function(a,i){var l=n.apply(e,o);function r(n){t(l,a,i,r,s,"next",n)}function s(n){t(l,a,i,r,s,"throw",n)}r(void 0)})}}Office.onReady(function(n){n.host===Office.HostType.Outlook&&(window.createOrderAcknowledgementDraft=K,window.sendAcknowledgementEmail=Y,function(){s.apply(this,arguments)}())});var a=null,i=0;function l(){console.log("loadSampleData function called!"),window.loadSampleData=l;var n={company_info:{account_number:"781",customer_po_number:"11082962",po_date:"2025-10-01T13:21:21.395581Z",company_name:"NAK CONSTRUCTION SERVICES LLC",billing_company_name:"NAK CONSTRUCTION SERVICES LLC",shipping_address:"140 SOUTH HOLLAND DRIVE, PENDERGRASS, GA 30567",shipping_method:"GROUND",shipping_account_number:"prepaid & add"},line_items:[{internal_part_number:"ZTIP107D73",description:"CUTTING TIP KOIKE #3",quantity:"5",unit_price:"19.80",external_part_number:"ZTIP107D73",mapping_status:"mapped",mapping_confidence:95},{internal_part_number:"ZTIP107D74",description:"TIP, CUTTING 107D7 #4 NAT GAS",quantity:"5",unit_price:"19.80",external_part_number:"ZTIP107D74",mapping_status:"mapped",mapping_confidence:95},{internal_part_number:"ZTIP107D75",description:"TIP 107D7 #5 HIGH SPEED NATURAL GAS CUTTING TIP",quantity:"10",unit_price:"18.00",external_part_number:"ZTIP107D75",mapping_status:"mapped",mapping_confidence:95}]};a=n,i=0,N(n,null,null).catch(console.error)}function r(){var n,e;console.log("showFallbackForm function called!"),window.showFallbackForm=r;var t=Office.context.mailbox.item.subject,o=(null===(n=Office.context.mailbox.item.from)||void 0===n?void 0:n.displayName)||(null===(e=Office.context.mailbox.item.from)||void 0===e?void 0:e.emailAddress)||"Unknown",l={company_info:{account_number:"",customer_po_number:"",po_date:(new Date).toISOString(),company_name:"",shipping_address:"",shipping_method:"GROUND",shipping_account_number:"prepaid & add"},line_items:[{internal_part_number:"",description:"",quantity:"",unit_price:"",external_part_number:"",mapping_status:"manual",mapping_confidence:0}],email_context:{subject:t,from:o}};a=l,i=0,N(l,null,null).catch(console.error)}function s(){return(s=o(n().m(function e(){var t;return n().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,w(),Office.context.mailbox.addHandlerAsync(Office.EventType.ItemChanged,c),n.n=1,D();case 1:return n.n=2,u();case 2:if(n.v){n.n=3;break}return n.n=3,P();case 3:n.n=5;break;case 4:n.p=4,t=n.v,console.error("Error initializing app:",t),_("Failed to initialize the application: "+t.message);case 5:return n.a(2)}},e,null,[[0,4]])}))).apply(this,arguments)}function c(){return d.apply(this,arguments)}function d(){return(d=o(n().m(function e(){var t;return n().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,D();case 1:return n.n=2,u();case 2:if(n.v){n.n=3;break}return n.n=3,P();case 3:n.n=5;break;case 4:n.p=4,t=n.v,console.error("Error handling item change:",t);case 5:return n.a(2)}},e,null,[[0,4]])}))).apply(this,arguments)}function u(){return p.apply(this,arguments)}function p(){return(p=o(n().m(function e(){return n().w(function(n){for(;;)if(0===n.n)return n.a(2,new Promise(function(n){Office.context.mailbox.item.categories.getAsync(function(e){if(e.status===Office.AsyncResultStatus.Succeeded){var t=e.value,o=t.some(function(n){return"Pending Approval"===n.displayName}),a=t.some(function(n){return"Missing Info"===n.displayName}),i=t.some(function(n){return"Approved"===n.displayName});o||a||i?(console.log("Email has processing tag, loading review UI..."),m(t),n(!0)):n(!1)}else n(!1)})}))},e)}))).apply(this,arguments)}function m(n){return v.apply(this,arguments)}function v(){return(v=o(n().m(function e(t){var o,a,s,c,d,u,p,v,b,y,g,h;return n().w(function(n){for(;;)switch(n.p=n.n){case 0:if(window.loadReviewUI=m,n.p=1,o=t.some(function(n){return"Approved"===n.displayName}),a=Office.context.mailbox.item.conversationId,s=Office.context.mailbox.item.subject,c=Office.context.mailbox.item.attachments,d="",c&&c.length>0&&(u=c.find(function(n){return n.name.toLowerCase().endsWith(".pdf")}))&&(d=u.name),!o){n.n=3;break}return console.log("Email is approved, showing read-only form..."),n.n=2,f(t);case 2:return n.a(2);case 3:return(p=document.querySelector(".card-body"))&&(p.innerHTML='\n        <div class="text-center">\n          <div class="spinner-border text-primary" role="status">\n            <span class="visually-hidden">Loading...</span>\n        </div>\n          <p class="mt-3">Processing email: "'.concat(s,'"</p>\n          <p class="text-muted small">Attachment: ').concat(d||"None",'</p>\n          <div class="mt-3">\n            <button class="btn btn-sm btn-outline-secondary me-2" id="loadSampleDataBtn">\n              <i class="fas fa-flask"></i> Load Sample Data (Debug)\n      </button>\n            <button class="btn btn-sm btn-outline-primary" id="skipLoadingBtn">\n              <i class="fas fa-forward"></i> Skip to Manual Entry\n      </button>\n    </div>\n    </div>\n  '),setTimeout(function(){var n=document.getElementById("loadSampleDataBtn"),e=document.getElementById("skipLoadingBtn");n&&n.addEventListener("click",l),e&&e.addEventListener("click",r)},100)),n.p=4,n.n=5,fetch("https://bx3w2xz6f6.us-east-1.awsapprunner.com/api/get_processed_email?email_id=".concat(encodeURIComponent(a),"&subject=").concat(encodeURIComponent(s),"&attachment_name=").concat(encodeURIComponent(d)),{method:"GET",headers:{"Content-Type":"application/json"}});case 5:if((v=n.v).ok){n.n=6;break}throw new Error("HTTP error! status: ".concat(v.status));case 6:return n.n=7,v.json();case 7:if(!(b=n.v).success||!b.data){n.n=9;break}return i=b.file_id||0,n.n=8,N(b.data,b.reviewReport,b.validation);case 8:n.n=10;break;case 9:throw new Error(b.message||"No processed data found");case 10:n.n=12;break;case 11:n.p=11,g=n.v,console.error("Error fetching from Flask server:",g),(y=document.querySelector(".card-body"))&&(y.innerHTML='\n          <div class="alert alert-warning">\n            <h5><i class="fas fa-exclamation-triangle"></i> Flask Server Connection Error</h5>\n            <p><strong>Error:</strong> '.concat(g.message,'</p>\n            <p>Could not connect to the processing server. This might be because:</p>\n            <ul>\n              <li>Flask server is not running on port 5000</li>\n              <li>Email hasn\'t been processed yet</li>\n              <li>Network connectivity issues</li>\n            </ul>\n            <div class="mt-3">\n              <button class="btn btn-primary me-2" onclick="location.reload()">\n                <i class="fas fa-sync"></i> Retry\n              </button>\n              <button class="btn btn-outline-secondary" onclick="showFallbackForm()">\n                <i class="fas fa-edit"></i> Manual Entry\n              </button>\n      </div>\n    </div>\n  '));case 12:n.n=14;break;case 13:n.p=13,h=n.v,console.error("Error loading review UI:",h),_("Failed to load email data: "+h.message);case 14:return n.a(2)}},e,null,[[4,11],[1,13]])}))).apply(this,arguments)}function f(n){return b.apply(this,arguments)}function b(){return(b=o(n().m(function e(t){var o,a,l,r,s,c,d,u,p;return n().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,o=Office.context.mailbox.item.conversationId,a=Office.context.mailbox.item.subject,l=Office.context.mailbox.item.attachments,r="",l&&l.length>0&&(s=l.find(function(n){return n.name.toLowerCase().endsWith(".pdf")}))&&(r=s.name),n.p=1,n.n=2,fetch("https://bx3w2xz6f6.us-east-1.awsapprunner.com/api/get_processed_email?email_id=".concat(encodeURIComponent(o),"&subject=").concat(encodeURIComponent(a),"&attachment_name=").concat(encodeURIComponent(r)),{method:"GET",headers:{"Content-Type":"application/json"}});case 2:if((c=n.v).ok){n.n=3;break}throw new Error("HTTP error! status: ".concat(c.status));case 3:return n.n=4,c.json();case 4:if(!(d=n.v).success||!d.data){n.n=6;break}return i=d.file_id||0,n.n=5,y(d.data,d.reviewReport,d.validation);case 5:n.n=7;break;case 6:throw new Error(d.message||"No processed data found");case 7:n.n=9;break;case 8:n.p=8,u=n.v,console.error("Error fetching approved email data:",u),_("Could not load approved order data: "+u.message);case 9:n.n=11;break;case 10:n.p=10,p=n.v,console.error("Error loading approved email data:",p),_("Failed to load approved email data: "+p.message);case 11:return n.a(2)}},e,null,[[1,8],[0,10]])}))).apply(this,arguments)}function y(n,e,t){return g.apply(this,arguments)}function g(){return(g=o(n().m(function e(t,o,i){var l,r,s,c;return n().w(function(n){for(;;)switch(n.n){case 0:return a=t,n.n=1,x(t);case 1:l=n.v,r=(new Date).toLocaleString(),(s=document.querySelector(".card-body"))&&(s.innerHTML='\n      <div id="formView">\n        <div class="card" id="epicorFormCard">\n          <div class="card-header bg-success text-white">\n            <h5 class="mb-0"><i class="fas fa-check-circle"></i> Entered '.concat(r,'</h5>\n          </div>\n          <div class="card-body">\n            \x3c!-- Order Header Section --\x3e\n            <div class="mb-4">\n              <h6 class="border-bottom pb-2"><i class="fas fa-heading"></i> Order Header</h6>\n              <div class="row">\n                <div class="col-md-6">\n                  <div class="mb-3">\n                    <label class="form-label">Customer Number *</label>\n                    <input type="text" class="form-control" id="custNum" value="').concat(l.custNum,'" readonly>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">Customer Name</label>\n                    <input type="text" class="form-control" id="customerName" value="').concat(l.customerName||"",'" readonly>\n                    <small class="form-text text-muted">Extracted from account number</small>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">PO Number *</label>\n                    <input type="text" class="form-control" id="poNum" value="').concat(l.poNum,'" readonly>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">Order Date</label>\n                    <input type="datetime-local" class="form-control" id="orderDate" value="').concat(l.orderDate,'" readonly>\n                  </div>\n                </div>\n                <div class="col-md-6">\n                  <div class="mb-3">\n                    <label class="form-label">Ship Via Code</label>\n                    <select class="form-select" id="shipViaCode" disabled>\n                      <option value="INVO" ').concat("INVO"===l.shipViaCode?"selected":"",'>INVO</option>\n                      <option value="UPS" ').concat("UPS"===l.shipViaCode?"selected":"",'>UPS</option>\n                      <option value="FEDEX" ').concat("FEDEX"===l.shipViaCode?"selected":"",'>FEDEX</option>\n                      <option value="TRUCK" ').concat("TRUCK"===l.shipViaCode?"selected":"",'>TRUCK</option>\n                    </select>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">Payment Flag</label>\n                    <select class="form-select" id="payFlag" disabled>\n                      <option value="SHIP" ').concat("SHIP"===l.payFlag?"selected":"",'>SHIP</option>\n                      <option value="PREPAID" ').concat("PREPAID"===l.payFlag?"selected":"",'>PREPAID</option>\n                      <option value="COD" ').concat("COD"===l.payFlag?"selected":"",'>COD</option>\n                    </select>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">Shipping Method</label>\n                    <select class="form-select" id="shippingMethod" disabled>\n                      <option value="GROUND" ').concat("GROUND"===l.shippingMethod?"selected":"",'>Ground</option>\n                      <option value="2ND_DAY_AIR" ').concat("2ND_DAY_AIR"===l.shippingMethod?"selected":"",'>2nd Day Air</option>\n                      <option value="NEXT_DAY_AIR" ').concat("NEXT_DAY_AIR"===l.shippingMethod?"selected":"",'>Next Day Air</option>\n                    </select>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">Shipping Account Number</label>\n                    <input type="text" class="form-control" id="shippingAccountNumber" value="').concat(l.shippingAccountNumber,'" readonly>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            \x3c!-- One-Time Ship Address Section --\x3e\n            <div class="mb-4">\n              <h6 class="border-bottom pb-2"><i class="fas fa-map-marker-alt"></i> One-Time Ship Address</h6>\n              <div class="form-check mb-3">\n                <input class="form-check-input" type="checkbox" id="useOTS" ').concat(l.useOTS?"checked":"",' disabled>\n                <label class="form-check-label" for="useOTS">Use One-Time Ship Address</label>\n              </div>\n              <div class="row">\n                <div class="col-md-6">\n                  <div class="mb-3">\n                    <label class="form-label">Company Name *</label>\n                    <input type="text" class="form-control" id="otsName" value="').concat(l.otsName,'" readonly>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">Address Line 1 *</label>\n                    <input type="text" class="form-control" id="otsAddress1" value="').concat(l.otsAddress1,'" readonly>\n                  </div>\n                </div>\n                <div class="col-md-6">\n                  <div class="mb-3">\n                    <label class="form-label">City *</label>\n                    <input type="text" class="form-control" id="otsCity" value="').concat(l.otsCity,'" readonly>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">State *</label>\n                    <select class="form-select" id="otsState" disabled>\n                      <option value="">Select State</option>\n                      <option value="AL">AL</option><option value="AK">AK</option><option value="AZ">AZ</option>\n                      <option value="AR">AR</option><option value="CA">CA</option><option value="CO">CO</option>\n                      <option value="CT">CT</option><option value="DE">DE</option><option value="FL">FL</option>\n                      <option value="GA">GA</option><option value="HI">HI</option><option value="ID">ID</option>\n                      <option value="IL">IL</option><option value="IN">IN</option><option value="IA">IA</option>\n                      <option value="KS">KS</option><option value="KY">KY</option><option value="LA">LA</option>\n                      <option value="ME">ME</option><option value="MD">MD</option><option value="MA">MA</option>\n                      <option value="MI">MI</option><option value="MN">MN</option><option value="MS">MS</option>\n                      <option value="MO">MO</option><option value="MT">MT</option><option value="NE">NE</option>\n                      <option value="NV">NV</option><option value="NH">NH</option><option value="NJ">NJ</option>\n                      <option value="NM">NM</option><option value="NY">NY</option><option value="NC">NC</option>\n                      <option value="ND">ND</option><option value="OH">OH</option><option value="OK">OK</option>\n                      <option value="OR">OR</option><option value="PA">PA</option><option value="RI">RI</option>\n                      <option value="SC">SC</option><option value="SD">SD</option><option value="TN">TN</option>\n                      <option value="TX">TX</option><option value="UT">UT</option><option value="VT">VT</option>\n                      <option value="VA">VA</option><option value="WA">WA</option><option value="WV">WV</option>\n                      <option value="WI">WI</option><option value="WY">WY</option>\n                    </select>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">ZIP Code *</label>\n                    <input type="text" class="form-control" id="otsZip" value="').concat(l.otsZip,'" readonly>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            \x3c!-- Line Items Section --\x3e\n            <div class="mb-4">\n              <h6 class="border-bottom pb-2"><i class="fas fa-list"></i> Line Items</h6>\n              <div id="lineItemsContainer">\n                ').concat(h(l.lineItems),'\n              </div>\n            </div>\n\n            \x3c!-- Read-only notice --\x3e\n            <div class="alert alert-info">\n              <i class="fas fa-info-circle"></i> This order has been entered and cannot be modified.\n            </div>\n          </div>\n        </div>\n      </div>\n    '),(c=document.getElementById("otsState"))&&(c.value=l.otsState));case 2:return n.a(2)}},e)}))).apply(this,arguments)}function h(n){return n&&0!==n.length?n.map(function(n,e){return'\n    <div class="line-item-card" data-index="'.concat(e,'">\n      <div class="row">\n        <div class="col-md-4">\n          <div class="mb-2">\n            <label class="form-label">Part Number *</label>\n            <input type="text" class="form-control" id="partNum_').concat(e,'" value="').concat(n.internal_part_number||"",'" readonly>\n          </div>\n        </div>\n        <div class="col-md-3">\n          <div class="mb-2">\n            <label class="form-label">Qty *</label>\n            <input type="number" class="form-control" id="sellingQuantity_').concat(e,'" value="').concat(n.quantity||"",'" readonly>\n          </div>\n        </div>\n        <div class="col-md-3">\n          <div class="mb-2">\n            <label class="form-label">Price *</label>\n            <input type="number" class="form-control" id="docUnitPrice_').concat(e,'" value="').concat(n.unit_price||"",'" readonly>\n          </div>\n        </div>\n        <div class="col-md-2">\n          <div class="mb-2">\n            <label class="form-label">Total</label>\n            <input type="text" class="form-control" id="lineTotal_').concat(e,'" value="').concat(((parseFloat(n.quantity)||0)*(parseFloat(n.unit_price)||0)).toFixed(2),'" readonly>\n          </div>\n        </div>\n      </div>\n      <div class="row">\n        <div class="col-12">\n          <div class="mb-2">\n            <label class="form-label">Description</label>\n            <input type="text" class="form-control" id="lineDesc_').concat(e,'" value="').concat(n.description||"",'" readonly>\n          </div>\n        </div>\n      </div>\n      <div class="row">\n        <div class="col-12">\n          <small class="text-muted">\n            <strong>Ext:</strong> ').concat(n.external_part_number||"N/A",' | \n            <strong>Status:</strong> <span class="badge bg-success">Approved</span> | \n            <strong>Conf:</strong> ').concat((n.mapping_confidence||0).toFixed(1),"%\n          </small>\n        </div>\n      </div>\n    </div>\n  ")}).join(""):'<p class="text-muted small">No line items found</p>'}function _(n){window.showError=_;var e=document.querySelector(".card-body");e&&(e.innerHTML='\n      <div class="alert alert-danger">\n        <h5><i class="fas fa-exclamation-triangle"></i> Error</h5>\n        <p>'.concat(n,"</p>\n      </div>\n    "))}function N(n,e,t){return S.apply(this,arguments)}function S(){return(S=o(n().m(function e(t,o,i){var l,r,s;return n().w(function(n){for(;;)switch(n.n){case 0:return a=t,n.n=1,x(t);case 1:l=n.v,(r=document.querySelector(".card-body"))&&(r.innerHTML='\n      <div id="formView">\n        <div class="card" id="epicorFormCard">\n          <div class="card-header">\n            <h5 class="mb-0"><i class="fas fa-file-invoice"></i> Epicor Order Form</h5>\n          </div>\n          <div class="card-body">\n            \x3c!-- Order Header Section --\x3e\n            <div class="mb-4">\n              <h6 class="border-bottom pb-2"><i class="fas fa-heading"></i> Order Header</h6>\n              <div class="row">\n                <div class="col-md-6">\n                  <div class="mb-3">\n                    <label class="form-label">Customer Number *</label>\n                    <input type="text" class="form-control" id="custNum" value="'.concat(l.custNum,'" required>\n                    <div class="field-error" id="custNum_error" style="display: none;"></div>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">Customer Name</label>\n                    <input type="text" class="form-control" id="customerName" value="').concat(l.customerName||"",'" readonly>\n                    <small class="form-text text-muted">Extracted from bill-to address</small>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">PO Number *</label>\n                    <input type="text" class="form-control" id="poNum" value="').concat(l.poNum,'" required>\n                    <div class="field-error" id="poNum_error" style="display: none;"></div>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">Order Date</label>\n                    <input type="datetime-local" class="form-control" id="orderDate" value="').concat(l.orderDate,'">\n                  </div>\n                </div>\n                <div class="col-md-6">\n                  <div class="mb-3">\n                    <label class="form-label">Ship Via Code</label>\n                    <select class="form-select" id="shipViaCode">\n                      <option value="INVO" ').concat("INVO"===l.shipViaCode?"selected":"",'>INVO</option>\n                      <option value="UPS" ').concat("UPS"===l.shipViaCode?"selected":"",'>UPS</option>\n                      <option value="FEDEX" ').concat("FEDEX"===l.shipViaCode?"selected":"",'>FEDEX</option>\n                      <option value="TRUCK" ').concat("TRUCK"===l.shipViaCode?"selected":"",'>TRUCK</option>\n                    </select>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">Payment Flag</label>\n                    <select class="form-select" id="payFlag">\n                      <option value="SHIP" ').concat("SHIP"===l.payFlag?"selected":"",'>SHIP</option>\n                      <option value="PREPAID" ').concat("PREPAID"===l.payFlag?"selected":"",'>PREPAID</option>\n                      <option value="COD" ').concat("COD"===l.payFlag?"selected":"",'>COD</option>\n                    </select>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">Shipping Method</label>\n                    <select class="form-select" id="shippingMethod">\n                      <option value="GROUND" ').concat("GROUND"===l.shippingMethod?"selected":"",'>Ground</option>\n                      <option value="2ND_DAY_AIR" ').concat("2ND_DAY_AIR"===l.shippingMethod?"selected":"",'>2nd Day Air</option>\n                      <option value="NEXT_DAY_AIR" ').concat("NEXT_DAY_AIR"===l.shippingMethod?"selected":"",'>Next Day Air</option>\n                    </select>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">Shipping Account Number</label>\n                    <input type="text" class="form-control" id="shippingAccountNumber" value="').concat(l.shippingAccountNumber,'">\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            \x3c!-- One-Time Ship Address Section --\x3e\n            <div class="mb-4">\n              <h6 class="border-bottom pb-2"><i class="fas fa-map-marker-alt"></i> One-Time Ship Address</h6>\n              <div class="form-check mb-3">\n                <input class="form-check-input" type="checkbox" id="useOTS" ').concat(l.useOTS?"checked":"",'>\n                <label class="form-check-label" for="useOTS">Use One-Time Ship Address</label>\n              </div>\n              <div class="row">\n                <div class="col-md-6">\n                  <div class="mb-3">\n                    <label class="form-label">Company Name *</label>\n                    <input type="text" class="form-control" id="otsName" value="').concat(l.otsName,'" required>\n                    <div class="field-error" id="otsName_error" style="display: none;"></div>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">Address Line 1 *</label>\n                    <input type="text" class="form-control" id="otsAddress1" value="').concat(l.otsAddress1,'" required>\n                    <div class="field-error" id="otsAddress1_error" style="display: none;"></div>\n                  </div>\n                </div>\n                <div class="col-md-6">\n                  <div class="mb-3">\n                    <label class="form-label">City *</label>\n                    <input type="text" class="form-control" id="otsCity" value="').concat(l.otsCity,'" required>\n                    <div class="field-error" id="otsCity_error" style="display: none;"></div>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">State *</label>\n                    <select class="form-select" id="otsState" required>\n                      <option value="">Select State</option>\n                      <option value="AL">AL</option><option value="AK">AK</option><option value="AZ">AZ</option>\n                      <option value="AR">AR</option><option value="CA">CA</option><option value="CO">CO</option>\n                      <option value="CT">CT</option><option value="DE">DE</option><option value="FL">FL</option>\n                      <option value="GA">GA</option><option value="HI">HI</option><option value="ID">ID</option>\n                      <option value="IL">IL</option><option value="IN">IN</option><option value="IA">IA</option>\n                      <option value="KS">KS</option><option value="KY">KY</option><option value="LA">LA</option>\n                      <option value="ME">ME</option><option value="MD">MD</option><option value="MA">MA</option>\n                      <option value="MI">MI</option><option value="MN">MN</option><option value="MS">MS</option>\n                      <option value="MO">MO</option><option value="MT">MT</option><option value="NE">NE</option>\n                      <option value="NV">NV</option><option value="NH">NH</option><option value="NJ">NJ</option>\n                      <option value="NM">NM</option><option value="NY">NY</option><option value="NC">NC</option>\n                      <option value="ND">ND</option><option value="OH">OH</option><option value="OK">OK</option>\n                      <option value="OR">OR</option><option value="PA">PA</option><option value="RI">RI</option>\n                      <option value="SC">SC</option><option value="SD">SD</option><option value="TN">TN</option>\n                      <option value="TX">TX</option><option value="UT">UT</option><option value="VT">VT</option>\n                      <option value="VA">VA</option><option value="WA">WA</option><option value="WV">WV</option>\n                      <option value="WI">WI</option><option value="WY">WY</option>\n                    </select>\n                    <div class="field-error" id="otsState_error" style="display: none;"></div>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">ZIP Code *</label>\n                    <input type="text" class="form-control" id="otsZip" value="').concat(l.otsZip,'" required>\n                    <div class="field-error" id="otsZip_error" style="display: none;"></div>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            \x3c!-- Line Items Section --\x3e\n            <div class="mb-4">\n              <div class="d-flex justify-content-between align-items-center mb-3">\n                <h6 class="mb-0 border-bottom pb-2"><i class="fas fa-list"></i> Line Items</h6>\n                <button type="button" class="btn btn-sm btn-outline-primary" id="addLineItem">\n                  <i class="fas fa-plus"></i> Add Item\n        </button>\n      </div>\n              <div id="lineItemsContainer">\n                ').concat(T(l.lineItems),'\n    </div>\n            </div>\n\n            \x3c!-- Action Buttons --\x3e\n            <div class="d-flex gap-2">\n              <button type="button" class="btn btn-primary" id="saveFormBtn">\n                <i class="fas fa-save"></i> Save & Enter Order\n              </button>\n              <button type="button" class="btn btn-outline-secondary" id="resetFormBtn">\n                <i class="fas fa-undo"></i> Reset\n        </button>\n      </div>\n    </div>\n      </div>\n    </div>\n  '),R(),(s=document.getElementById("otsState"))&&(s.value=l.otsState),setTimeout(function(){U()},100));case 2:return n.a(2)}},e)}))).apply(this,arguments)}function I(){return(I=o(n().m(function e(t){var o,a,l,r,s,c;return n().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,o=Office.context.mailbox.item.itemId,a=Office.context.mailbox.item.subject,l=i?"attachment_".concat(i):"unknown",n.n=1,fetch("https://bx3w2xz6f6.us-east-1.awsapprunner.com/api/save_updated_data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email_id:o,subject:a,attachment_name:l,updated_data:t})});case 1:if((r=n.v).ok){n.n=2;break}throw new Error("HTTP error! status: ".concat(r.status));case 2:return n.n=3,r.json();case 3:s=n.v,console.log("Data saved to server:",s),n.n=5;break;case 4:n.p=4,c=n.v,console.error("Error saving updated data to server:",c);case 5:return n.a(2)}},e,null,[[0,4]])}))).apply(this,arguments)}function A(n){return O.apply(this,arguments)}function O(){return(O=o(n().m(function e(t){var o,a,i;return n().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,fetch("http://localhost:5000/api/get_customer_by_account?account_number=".concat(encodeURIComponent(t)));case 1:return o=n.v,n.n=2,o.json();case 2:if(!(a=n.v).success||!a.customer){n.n=3;break}return n.a(2,a.customer.company_name);case 3:return n.a(2,"");case 4:return n.p=4,i=n.v,console.error("Error looking up customer:",i),n.a(2,"")}},e,null,[[0,4]])}))).apply(this,arguments)}function x(n){return E.apply(this,arguments)}function E(){return(E=o(n().m(function e(t){var o,a,i,l,r,s,c,d,u,p,m,v,f,b,y,g,h,_,N,S;return n().w(function(n){for(;;)switch(n.n){case 0:if(!(t.ds&&t.ds.OrderHed&&t.ds.OrderHed.length>0)){n.n=2;break}return u=t.ds.OrderHed[0],p=t.ds.OrderDtl||[],n.n=1,A(u.CustNum||"");case 1:return m=n.v,n.a(2,{custNum:u.CustNum||"",poNum:u.PONum||"",customerName:m,orderDate:u.OrderDate?new Date(u.OrderDate).toISOString().slice(0,16):(new Date).toISOString().slice(0,16),shipViaCode:u.ShipViaCode||"INVO",payFlag:u.PayFlag||"SHIP",shippingMethod:"2ND_DAY_AIR"===u.ShippingMethod?"2ND_DAY_AIR":"NEXT_DAY_AIR"===u.ShippingMethod?"NEXT_DAY_AIR":"GROUND",shippingAccountNumber:u.ShippingAccountNumber||"prepaid & add",useOTS:u.UseOTS||!1,otsName:u.OTSName||"",otsAddress1:u.OTSAddress1||"",otsCity:u.OTSCity||"",otsState:u.OTSState||"",otsZip:u.OTSZip||"",lineItems:p.map(function(n){return{internal_part_number:n.PartNum||"",description:n.LineDesc||"",quantity:n.SellingQuantity||"",unit_price:n.DocUnitPrice||"",external_part_number:n.PartNum||"",mapping_status:"mapped",mapping_confidence:95}})});case 2:return v=(null===(o=t.company_info)||void 0===o?void 0:o.account_number)||"",f=(null===(a=t.company_info)||void 0===a?void 0:a.customer_po_number)||"",n.n=3,A((null===(i=t.company_info)||void 0===i?void 0:i.account_number)||"");case 3:return b=n.v,y=null!==(l=t.company_info)&&void 0!==l&&l.po_date?new Date(t.company_info.po_date).toISOString().slice(0,16):(new Date).toISOString().slice(0,16),g=(null===(r=t.company_info)||void 0===r?void 0:r.shipping_method)||"GROUND",h=(null===(s=t.company_info)||void 0===s?void 0:s.shipping_account_number)||"prepaid & add",_=(null===(c=t.company_info)||void 0===c?void 0:c.company_name)||"",N=(null===(d=t.company_info)||void 0===d?void 0:d.shipping_address)||"",S=t.line_items||[],n.a(2,{custNum:v,poNum:f,customerName:b,orderDate:y,shipViaCode:"INVO",payFlag:"SHIP",shippingMethod:g,shippingAccountNumber:h,useOTS:!0,otsName:_,otsAddress1:N,otsCity:"",otsState:"",otsZip:"",lineItems:S})}},e)}))).apply(this,arguments)}function T(n){return n&&0!==n.length?n.map(function(n,e){return'\n    <div class="line-item-card" data-index="'.concat(e,'">\n      <div class="position-absolute top-0 end-0">\n        <button type="button" class="btn btn-sm btn-outline-danger" onclick="removeLineItem(').concat(e,')">\n          <i class="fas fa-times"></i>\n        </button>\n      </div>\n      <div class="row">\n        <div class="col-md-4">\n          <div class="mb-2">\n            <label class="form-label">Part Number *</label>\n            <input type="text" class="form-control" id="partNum_').concat(e,'" value="').concat(n.internal_part_number||"",'" placeholder="Part #" required>\n            <div class="field-error" id="partNum_error_').concat(e,'" style="display: none;"></div>\n          </div>\n        </div>\n        <div class="col-md-3">\n          <div class="mb-2">\n            <label class="form-label">Qty *</label>\n            <input type="number" class="form-control" id="sellingQuantity_').concat(e,'" value="').concat(n.quantity||"",'" placeholder="Qty" required>\n            <div class="field-error" id="sellingQuantity_error_').concat(e,'" style="display: none;"></div>\n          </div>\n        </div>\n        <div class="col-md-3">\n          <div class="mb-2">\n            <label class="form-label">Price *</label>\n            <input type="number" class="form-control" id="docUnitPrice_').concat(e,'" value="').concat(n.unit_price||"",'" step="0.01" placeholder="Price" required>\n            <div class="field-error" id="docUnitPrice_error_').concat(e,'" style="display: none;"></div>\n          </div>\n        </div>\n        <div class="col-md-2">\n          <div class="mb-2">\n            <label class="form-label">Total</label>\n            <input type="text" class="form-control" id="lineTotal_').concat(e,'" value="').concat(((parseFloat(n.quantity)||0)*(parseFloat(n.unit_price)||0)).toFixed(2),'" readonly>\n          </div>\n        </div>\n      </div>\n      <div class="row">\n        <div class="col-12">\n          <div class="mb-2">\n            <label class="form-label">Description</label>\n            <input type="text" class="form-control" id="lineDesc_').concat(e,'" value="').concat(n.description||"",'" placeholder="Description">\n          </div>\n        </div>\n      </div>\n      <div class="row">\n        <div class="col-12">\n          <small class="text-muted">\n            <strong>Ext:</strong> ').concat(n.external_part_number||"N/A",' | \n            <strong>Status:</strong> <span class="badge bg-').concat("mapped"===n.mapping_status?"success":"warning",'">').concat(n.mapping_status||"Unknown","</span> | \n            <strong>Conf:</strong> ").concat((n.mapping_confidence||0).toFixed(1),"%\n          </small>\n        </div>\n      </div>\n    </div>\n  ")}).join(""):'<p class="text-muted small">No line items found</p>'}function w(){console.log("Arzana: Background processing initialized")}function D(){return C.apply(this,arguments)}function C(){return(C=o(n().m(function e(){return n().w(function(n){for(;;)if(0===n.n)return n.a(2,Promise.resolve())},e)}))).apply(this,arguments)}function P(){return k.apply(this,arguments)}function k(){return(k=o(n().m(function e(){return n().w(function(n){for(;;)if(0===n.n)return n.a(2,Promise.resolve())},e)}))).apply(this,arguments)}function R(){var n=document.getElementById("addLineItem");null==n||n.addEventListener("click",M);var e=document.getElementById("saveFormBtn");null==e||e.addEventListener("click",F);var t=document.getElementById("resetFormBtn");null==t||t.addEventListener("click",L),document.querySelectorAll("#formView input, #formView select").forEach(function(n){n.addEventListener("blur",V),n.addEventListener("input",function(n){!function(n){var e=n.target;e.classList.remove("is-invalid");var t=e.id+"_error",o=document.getElementById(t);o&&(o.style.display="none")}(n),U()})})}function M(){var n=document.getElementById("lineItemsContainer");if(n){var e,t,o=n.children.length,a=(e={internal_part_number:"",description:"",quantity:"",unit_price:"",external_part_number:"",mapping_status:"manual",mapping_confidence:0},'\n    <div class="line-item-card" data-index="'.concat(t=o,'">\n      <div class="position-absolute top-0 end-0">\n        <button type="button" class="btn btn-sm btn-outline-danger" onclick="removeLineItem(').concat(t,')">\n          <i class="fas fa-times"></i>\n        </button>\n      </div>\n      <div class="row">\n        <div class="col-md-4">\n          <div class="mb-2">\n            <label class="form-label">Part Number *</label>\n            <input type="text" class="form-control" id="partNum_').concat(t,'" value="').concat(e.internal_part_number||"",'" placeholder="Part #" required>\n            <div class="field-error" id="partNum_error_').concat(t,'" style="display: none;"></div>\n          </div>\n        </div>\n        <div class="col-md-3">\n          <div class="mb-2">\n            <label class="form-label">Qty *</label>\n            <input type="number" class="form-control" id="sellingQuantity_').concat(t,'" value="').concat(e.quantity||"",'" placeholder="Qty" required>\n            <div class="field-error" id="sellingQuantity_error_').concat(t,'" style="display: none;"></div>\n          </div>\n        </div>\n        <div class="col-md-3">\n          <div class="mb-2">\n            <label class="form-label">Price *</label>\n            <input type="number" class="form-control" id="docUnitPrice_').concat(t,'" value="').concat(e.unit_price||"",'" step="0.01" placeholder="Price" required>\n            <div class="field-error" id="docUnitPrice_error_').concat(t,'" style="display: none;"></div>\n          </div>\n        </div>\n        <div class="col-md-2">\n          <div class="mb-2">\n            <label class="form-label">Total</label>\n            <input type="text" class="form-control" id="lineTotal_').concat(t,'" value="').concat(((parseFloat(e.quantity)||0)*(parseFloat(e.unit_price)||0)).toFixed(2),'" readonly>\n          </div>\n        </div>\n      </div>\n      <div class="row">\n        <div class="col-12">\n          <div class="mb-2">\n            <label class="form-label">Description</label>\n            <input type="text" class="form-control" id="lineDesc_').concat(t,'" value="').concat(e.description||"",'" placeholder="Description">\n          </div>\n        </div>\n      </div>\n      <div class="row">\n        <div class="col-12">\n          <small class="text-muted">\n            <strong>Ext:</strong> ').concat(e.external_part_number||"N/A",' | \n            <strong>Status:</strong> <span class="badge bg-').concat("mapped"===e.mapping_status?"success":"warning",'">').concat(e.mapping_status||"Unknown","</span> | \n            <strong>Conf:</strong> ").concat((e.mapping_confidence||0).toFixed(1),"%\n          </small>\n        </div>\n      </div>\n    </div>\n  "));n.insertAdjacentHTML("beforeend",a);var i=n.lastElementChild;i&&i.querySelectorAll("input").forEach(function(n){n.addEventListener("blur",function(){return H(o)}),n.addEventListener("input",function(){return function(n){["partNum_".concat(n),"sellingQuantity_".concat(n),"docUnitPrice_".concat(n)].forEach(function(n){var e=document.getElementById(n);if(e){e.classList.remove("is-invalid");var t=document.getElementById(n+"_error");t&&(t.style.display="none")}})}(o)})})}}function F(){if(U()){var n,e,t,o,i,l,r,s,c,d,u,p,m,v,f,b,y,g,h,N,S,A,O,x,E,T,w,D=(v=(null===(n=document.getElementById("custNum"))||void 0===n?void 0:n.value)||"",f=(null===(e=document.getElementById("poNum"))||void 0===e?void 0:e.value)||"",b=(null===(t=document.getElementById("orderDate"))||void 0===t?void 0:t.value)||(new Date).toISOString().slice(0,16),y=(null===(o=document.getElementById("shipViaCode"))||void 0===o?void 0:o.value)||"INVO",g=(null===(i=document.getElementById("payFlag"))||void 0===i?void 0:i.value)||"SHIP",h=(null===(l=document.getElementById("shippingMethod"))||void 0===l?void 0:l.value)||"GROUND",N=(null===(r=document.getElementById("shippingAccountNumber"))||void 0===r?void 0:r.value)||"prepaid & add",S=(null===(s=document.getElementById("useOTS"))||void 0===s?void 0:s.checked)||!1,A=(null===(c=document.getElementById("otsName"))||void 0===c?void 0:c.value)||"",O=(null===(d=document.getElementById("otsAddress1"))||void 0===d?void 0:d.value)||"",x=(null===(u=document.getElementById("otsCity"))||void 0===u?void 0:u.value)||"",E=(null===(p=document.getElementById("otsState"))||void 0===p?void 0:p.value)||"",T=(null===(m=document.getElementById("otsZip"))||void 0===m?void 0:m.value)||"",w=[],document.querySelectorAll(".line-item-card").forEach(function(n,e){var t,o,a,i,l=(null===(t=document.getElementById("partNum_".concat(e)))||void 0===t?void 0:t.value)||"",r=(null===(o=document.getElementById("lineDesc_".concat(e)))||void 0===o?void 0:o.value)||"",s=(null===(a=document.getElementById("sellingQuantity_".concat(e)))||void 0===a?void 0:a.value)||"",c=(null===(i=document.getElementById("docUnitPrice_".concat(e)))||void 0===i?void 0:i.value)||"";(l||s||c)&&w.push({PartNum:l,LineDesc:r,SellingQuantity:parseFloat(s)||0,DocUnitPrice:parseFloat(c)||0})}),{ds:{OrderHed:[{CustNum:v,PONum:f,OrderDate:b,ShipViaCode:y,PayFlag:g,ShippingMethod:h,ShippingAccountNumber:N,UseOTS:S,OTSName:A,OTSAddress1:O,OTSCity:x,OTSState:E,OTSZip:T}],OrderDtl:w}});console.log("Saving updated form data:",D),a=D,function(n){I.apply(this,arguments)}(D);try{console.log("Starting tag update process..."),Office.context.mailbox.item.categories.getAsync(function(n){if(console.log("Current categories:",n),n.status===Office.AsyncResultStatus.Succeeded){var e=n.value;console.log("Current category names:",e.map(function(n){return n.displayName}));var t=e.filter(function(n){return["Pending Approval","Missing Info","Approved"].includes(n.displayName)}).map(function(n){return n.displayName});console.log("Tags to remove:",t),t.length>0?Office.context.mailbox.item.categories.removeAsync(t,function(n){console.log("Remove result:",n),Office.context.mailbox.item.categories.addAsync(["Approved"],function(n){var e;console.log("Add result:",n),n.status===Office.AsyncResultStatus.Succeeded?(G('Order entered successfully! Email tagged as "Approved"'),K()):(console.error("Add tag failed:",n.error),G("Order entered successfully! (Tag update failed: "+((null===(e=n.error)||void 0===e?void 0:e.message)||"Unknown error")+")"),K())})}):Office.context.mailbox.item.categories.addAsync(["Approved"],function(n){var e;console.log("Add result (no removal):",n),n.status===Office.AsyncResultStatus.Succeeded?(G('Order entered successfully! Email tagged as "Approved"'),K()):(console.error("Add tag failed:",n.error),G("Order entered successfully! (Tag update failed: "+((null===(e=n.error)||void 0===e?void 0:e.message)||"Unknown error")+")"),K())})}else console.error("Failed to get current categories:",n.error),G("Order entered successfully! (Could not read current tags)")})}catch(n){console.error("Error updating email tags:",n),G("Order entered successfully! (Tag update failed: "+n.message+")")}}else _('Please complete all required fields and remove any "MISSING" values before saving.')}function L(){confirm("Are you sure you want to reset the form? All changes will be lost.")&&N(a,null,null).catch(console.error)}function U(){var n=!0;[{id:"custNum",name:"Customer Number"},{id:"poNum",name:"PO Number"},{id:"otsName",name:"Company Name"},{id:"otsAddress1",name:"Address Line 1"},{id:"otsCity",name:"City"},{id:"otsState",name:"State"},{id:"otsZip",name:"ZIP Code"}].forEach(function(e){var t=document.getElementById(e.id);if(t){var o=t.value.trim(),a=o&&""!==o,i=o.toUpperCase().includes("MISSING");!a||i?(B(t,"".concat(e.name,i?' contains "MISSING" and needs to be filled':" is required")),n=!1):q(t)}}),document.querySelectorAll(".line-item-card").forEach(function(e,t){H(t)||(n=!1)});var e=document.getElementById("saveFormBtn");return e&&(e.disabled=!n,n?(e.innerHTML='<i class="fas fa-save"></i> Save & Enter Order',e.className="btn btn-primary"):(e.innerHTML='<i class="fas fa-exclamation-triangle"></i> Complete Required Fields',e.className="btn btn-warning")),n}function V(n){var e=n.target,t=e.value.trim();e.required&&!t?B(e,"This field is required"):"MISSING"===t||t.includes("MISSING")?B(e,'This field contains "MISSING" and needs to be filled'):q(e)}function H(n){var e=!0;return[{id:"partNum_".concat(n),name:"Part Number"},{id:"sellingQuantity_".concat(n),name:"Quantity"},{id:"docUnitPrice_".concat(n),name:"Unit Price"}].forEach(function(n){var t=document.getElementById(n.id);if(t){var o=t.value.trim(),a=o&&""!==o,i=o.toUpperCase().includes("MISSING");!a||i?(B(t,"".concat(n.name,i?' contains "MISSING" and needs to be filled':" is required")),e=!1):q(t)}}),e}function B(n,e){n.classList.remove("is-valid"),n.classList.add("is-invalid");var t=n.id+"_error",o=document.getElementById(t);o&&(o.textContent=e,o.style.display="block")}function q(n){n.classList.remove("is-invalid"),n.classList.add("is-valid");var e=n.id+"_error",t=document.getElementById(e);t&&(t.style.display="none")}function G(n){var e=document.createElement("div");e.className="alert alert-success alert-dismissible fade show position-fixed",e.style.cssText="top: 10px; right: 10px; z-index: 9999; min-width: 300px;",e.innerHTML="".concat(n,'<button type="button" class="btn-close" onclick="this.parentElement.remove()"></button>'),document.body.appendChild(e),setTimeout(function(){return e.remove()},3e3)}function j(n){var e,t,o=((null===(e=Office.context.mailbox.item.from)||void 0===e?void 0:e.displayName)||(null===(t=Office.context.mailbox.item.from)||void 0===t?void 0:t.emailAddress)||"Customer").split(" ")[0]||"Customer",a=0,i=n.lineItems.map(function(n){var e=(parseFloat(n.quantity)||0)*(parseFloat(n.unit_price)||0);return a+=e,"â€¢ ".concat(n.internal_part_number,": ").concat(n.quantity," @ $").concat(parseFloat(n.unit_price).toFixed(2)," = $").concat(e.toFixed(2))}).join("\n"),l=new Date;l.setDate(l.getDate()+3);var r=l.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});return"Hi ".concat(o,",\n\nPO").concat(n.poNum," processed successfully.\n\nAccount: ").concat(n.custNum,"\nParts:\n").concat(i,"\n\nTotal: $").concat(a.toFixed(2),"\nDelivery: ").concat(r,"\n\nThanks,\nWilliam")}function K(){return Z.apply(this,arguments)}function Z(){return(Z=o(n().m(function e(){var t,o,i,l;return n().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,x(a);case 1:o=n.v,i=j(o),Office.context.mailbox.displayNewMessageForm({toRecipients:[(null===(t=Office.context.mailbox.item.from)||void 0===t?void 0:t.emailAddress)||""],subject:"Order Acknowledgement - PO".concat(o.poNum),body:i,attachments:[]}),G("Order acknowledgement draft opened! Review and send when ready."),n.n=3;break;case 2:n.p=2,l=n.v,console.error("Error creating order acknowledgement draft:",l),_("Failed to create order acknowledgement draft: "+l.message);case 3:return n.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function Y(){try{K(),G("Acknowledgement draft opened! Review and send when ready.")}catch(n){console.error("Error opening acknowledgement email:",n),_("Failed to open acknowledgement email: "+n.message)}}new Set}();
//# sourceMappingURL=taskpane.js.map