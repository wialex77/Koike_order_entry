/*! For license information please see taskpane.js.LICENSE.txt */
!function(){function e(){var t,o,a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",l=a.toStringTag||"@@toStringTag";function r(e,a,i,l){var r=a&&a.prototype instanceof s?a:s,d=Object.create(r.prototype);return n(d,"_invoke",function(e,n,a){var i,l,r,s=0,d=a||[],u=!1,p={p:0,n:0,v:t,a:m,f:m.bind(t,4),d:function(e,n){return i=e,l=0,r=t,p.n=n,c}};function m(e,n){for(l=e,r=n,o=0;!u&&s&&!a&&o<d.length;o++){var a,i=d[o],m=p.p,v=i[2];e>3?(a=v===n)&&(r=i[(l=i[4])?5:(l=3,3)],i[4]=i[5]=t):i[0]<=m&&((a=e<2&&m<i[1])?(l=0,p.v=n,p.n=i[1]):m<v&&(a=e<3||i[0]>n||n>v)&&(i[4]=e,i[5]=n,p.n=v,l=0))}if(a||e>1)return c;throw u=!0,n}return function(a,d,v){if(s>1)throw TypeError("Generator is already running");for(u&&1===d&&m(d,v),l=d,r=v;(o=l<2?t:r)||!u;){i||(l?l<3?(l>1&&(p.n=-1),m(l,r)):p.n=r:p.v=r);try{if(s=2,i){if(l||(a="next"),o=i[a]){if(!(o=o.call(i,r)))throw TypeError("iterator result is not an object");if(!o.done)return o;r=o.value,l<2&&(l=0)}else 1===l&&(o=i.return)&&o.call(i),l<2&&(r=TypeError("The iterator does not provide a '"+a+"' method"),l=1);i=t}else if((o=(u=p.n<0)?r:e.call(n,p))!==c)break}catch(e){i=t,l=1,r=e}finally{s=1}}return{value:o,done:u}}}(e,i,l),!0),d}var c={};function s(){}function d(){}function u(){}o=Object.getPrototypeOf;var p=[][i]?o(o([][i]())):(n(o={},i,function(){return this}),o),m=u.prototype=s.prototype=Object.create(p);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,n(e,l,"GeneratorFunction")),e.prototype=Object.create(m),e}return d.prototype=u,n(m,"constructor",u),n(u,"constructor",d),d.displayName="GeneratorFunction",n(u,l,"GeneratorFunction"),n(m),n(m,l,"Generator"),n(m,i,function(){return this}),n(m,"toString",function(){return"[object Generator]"}),(e=function(){return{w:r,m:v}})()}function n(e,t,o,a){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}n=function(e,t,o,a){function l(t,o){n(e,t,function(e){return this._invoke(t,o,e)})}t?i?i(e,t,{value:o,enumerable:!a,configurable:!a,writable:!a}):e[t]=o:(l("next",0),l("throw",1),l("return",2))},n(e,t,o,a)}function t(e,n,t,o,a,i,l){try{var r=e[i](l),c=r.value}catch(e){return void t(e)}r.done?n(c):Promise.resolve(c).then(o,a)}function o(e){return function(){var n=this,o=arguments;return new Promise(function(a,i){var l=e.apply(n,o);function r(e){t(l,a,i,r,c,"next",e)}function c(e){t(l,a,i,r,c,"throw",e)}r(void 0)})}}Office.onReady(function(e){e.host===Office.HostType.Outlook&&(window.createOrderAcknowledgementDraft=K,window.sendAcknowledgementEmail=Y,function(){c.apply(this,arguments)}())});var a=null,i=0;function l(){console.log("loadSampleData function called!"),window.loadSampleData=l;var e={company_info:{account_number:"781",customer_po_number:"11082962",po_date:"2025-10-01T13:21:21.395581Z",company_name:"NAK CONSTRUCTION SERVICES LLC",billing_company_name:"NAK CONSTRUCTION SERVICES LLC",shipping_address:"140 SOUTH HOLLAND DRIVE, PENDERGRASS, GA 30567",shipping_method:"GROUND",shipping_account_number:"prepaid & add"},line_items:[{internal_part_number:"ZTIP107D73",description:"CUTTING TIP KOIKE #3",quantity:"5",unit_price:"19.80",external_part_number:"ZTIP107D73",mapping_status:"mapped",mapping_confidence:95},{internal_part_number:"ZTIP107D74",description:"TIP, CUTTING 107D7 #4 NAT GAS",quantity:"5",unit_price:"19.80",external_part_number:"ZTIP107D74",mapping_status:"mapped",mapping_confidence:95},{internal_part_number:"ZTIP107D75",description:"TIP 107D7 #5 HIGH SPEED NATURAL GAS CUTTING TIP",quantity:"10",unit_price:"18.00",external_part_number:"ZTIP107D75",mapping_status:"mapped",mapping_confidence:95}]};a=e,i=0,N(e,null,null).catch(console.error)}function r(){var e,n;console.log("showFallbackForm function called!"),window.showFallbackForm=r;var t=Office.context.mailbox.item.subject,o=(null===(e=Office.context.mailbox.item.from)||void 0===e?void 0:e.displayName)||(null===(n=Office.context.mailbox.item.from)||void 0===n?void 0:n.emailAddress)||"Unknown",l={company_info:{account_number:"",customer_po_number:"",po_date:(new Date).toISOString(),company_name:"",shipping_address:"",shipping_method:"GROUND",shipping_account_number:"prepaid & add"},line_items:[{internal_part_number:"",description:"",quantity:"",unit_price:"",external_part_number:"",mapping_status:"manual",mapping_confidence:0}],email_context:{subject:t,from:o}};a=l,i=0,N(l,null,null).catch(console.error)}function c(){return(c=o(e().m(function n(){var t;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,D(),Office.context.mailbox.addHandlerAsync(Office.EventType.ItemChanged,s),e.n=1,C();case 1:return e.n=2,u();case 2:if(e.v){e.n=3;break}return e.n=3,P();case 3:e.n=5;break;case 4:e.p=4,t=e.v,console.error("Error initializing app:",t),_("Failed to initialize the application: "+t.message);case 5:return e.a(2)}},n,null,[[0,4]])}))).apply(this,arguments)}function s(){return d.apply(this,arguments)}function d(){return(d=o(e().m(function n(){var t;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,C();case 1:return e.n=2,u();case 2:if(e.v){e.n=3;break}return e.n=3,P();case 3:e.n=5;break;case 4:e.p=4,t=e.v,console.error("Error handling item change:",t);case 5:return e.a(2)}},n,null,[[0,4]])}))).apply(this,arguments)}function u(){return p.apply(this,arguments)}function p(){return(p=o(e().m(function n(){return e().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e){Office.context.mailbox.item.categories.getAsync(function(n){if(n.status===Office.AsyncResultStatus.Succeeded){var t=n.value,o=t.some(function(e){return"Pending Approval"===e.displayName}),a=t.some(function(e){return"Missing Info"===e.displayName}),i=t.some(function(e){return"Approved"===e.displayName});o||a||i?(console.log("Email has processing tag, loading review UI..."),m(t),e(!0)):e(!1)}else e(!1)})}))},n)}))).apply(this,arguments)}function m(e){return v.apply(this,arguments)}function v(){return(v=o(e().m(function n(t){var o,a,c,s,d,u,p,v,b,y,g,h;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:if(window.loadReviewUI=m,e.p=1,o=t.some(function(e){return"Approved"===e.displayName}),a=Office.context.mailbox.item.conversationId,c=Office.context.mailbox.item.subject,s=Office.context.mailbox.item.attachments,d="",s&&s.length>0&&(u=s.find(function(e){return e.name.toLowerCase().endsWith(".pdf")}))&&(d=u.name),!o){e.n=3;break}return console.log("Email is approved, showing read-only form..."),e.n=2,f(t);case 2:return e.a(2);case 3:return(p=document.querySelector(".card-body"))&&(p.innerHTML='\n        <div class="text-center">\n          <div class="spinner-border text-primary" role="status">\n            <span class="visually-hidden">Loading...</span>\n        </div>\n          <p class="mt-3">Processing email: "'.concat(c,'"</p>\n          <p class="text-muted small">Attachment: ').concat(d||"None",'</p>\n          <div class="mt-3">\n            <button class="btn btn-sm btn-outline-secondary me-2" id="loadSampleDataBtn">\n              <i class="fas fa-flask"></i> Load Sample Data (Debug)\n      </button>\n            <button class="btn btn-sm btn-outline-primary" id="skipLoadingBtn">\n              <i class="fas fa-forward"></i> Skip to Manual Entry\n      </button>\n    </div>\n    </div>\n  '),setTimeout(function(){var e=document.getElementById("loadSampleDataBtn"),n=document.getElementById("skipLoadingBtn");e&&e.addEventListener("click",l),n&&n.addEventListener("click",r)},100)),e.p=4,e.n=5,fetch("http://127.0.0.1:5000/api/get_processed_email?email_id=".concat(encodeURIComponent(a),"&subject=").concat(encodeURIComponent(c),"&attachment_name=").concat(encodeURIComponent(d)),{method:"GET",headers:{"Content-Type":"application/json"}});case 5:if((v=e.v).ok){e.n=6;break}throw new Error("HTTP error! status: ".concat(v.status));case 6:return e.n=7,v.json();case 7:if(!(b=e.v).success||!b.data){e.n=9;break}return i=b.file_id||0,e.n=8,N(b.data,b.reviewReport,b.validation);case 8:e.n=10;break;case 9:throw new Error(b.message||"No processed data found");case 10:e.n=12;break;case 11:e.p=11,g=e.v,console.error("Error fetching from Flask server:",g),(y=document.querySelector(".card-body"))&&(y.innerHTML='\n          <div class="alert alert-warning">\n            <h5><i class="fas fa-exclamation-triangle"></i> Flask Server Connection Error</h5>\n            <p><strong>Error:</strong> '.concat(g.message,'</p>\n            <p>Could not connect to the processing server. This might be because:</p>\n            <ul>\n              <li>Flask server is not running on port 5000</li>\n              <li>Email hasn\'t been processed yet</li>\n              <li>Network connectivity issues</li>\n            </ul>\n            <div class="mt-3">\n              <button class="btn btn-primary me-2" onclick="location.reload()">\n                <i class="fas fa-sync"></i> Retry\n              </button>\n              <button class="btn btn-outline-secondary" onclick="showFallbackForm()">\n                <i class="fas fa-edit"></i> Manual Entry\n              </button>\n      </div>\n    </div>\n  '));case 12:e.n=14;break;case 13:e.p=13,h=e.v,console.error("Error loading review UI:",h),_("Failed to load email data: "+h.message);case 14:return e.a(2)}},n,null,[[4,11],[1,13]])}))).apply(this,arguments)}function f(e){return b.apply(this,arguments)}function b(){return(b=o(e().m(function n(t){var o,a,l,r,c,s,d,u,p;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,o=Office.context.mailbox.item.conversationId,a=Office.context.mailbox.item.subject,l=Office.context.mailbox.item.attachments,r="",l&&l.length>0&&(c=l.find(function(e){return e.name.toLowerCase().endsWith(".pdf")}))&&(r=c.name),e.p=1,e.n=2,fetch("http://127.0.0.1:5000/api/get_processed_email?email_id=".concat(encodeURIComponent(o),"&subject=").concat(encodeURIComponent(a),"&attachment_name=").concat(encodeURIComponent(r)),{method:"GET",headers:{"Content-Type":"application/json"}});case 2:if((s=e.v).ok){e.n=3;break}throw new Error("HTTP error! status: ".concat(s.status));case 3:return e.n=4,s.json();case 4:if(!(d=e.v).success||!d.data){e.n=6;break}return i=d.file_id||0,e.n=5,y(d.data,d.reviewReport,d.validation);case 5:e.n=7;break;case 6:throw new Error(d.message||"No processed data found");case 7:e.n=9;break;case 8:e.p=8,u=e.v,console.error("Error fetching approved email data:",u),_("Could not load approved order data: "+u.message);case 9:e.n=11;break;case 10:e.p=10,p=e.v,console.error("Error loading approved email data:",p),_("Failed to load approved email data: "+p.message);case 11:return e.a(2)}},n,null,[[1,8],[0,10]])}))).apply(this,arguments)}function y(e,n,t){return g.apply(this,arguments)}function g(){return(g=o(e().m(function n(t,o,i){var l,r,c,s;return e().w(function(e){for(;;)switch(e.n){case 0:return a=t,e.n=1,E(t);case 1:l=e.v,r=(new Date).toLocaleString(),(c=document.querySelector(".card-body"))&&(c.innerHTML='\n      <div id="formView">\n        <div class="card" id="epicorFormCard">\n          <div class="card-header bg-success text-white">\n            <h5 class="mb-0"><i class="fas fa-check-circle"></i> Entered '.concat(r,'</h5>\n          </div>\n          <div class="card-body">\n            \x3c!-- Order Header Section --\x3e\n            <div class="mb-4">\n              <h6 class="border-bottom pb-2"><i class="fas fa-heading"></i> Order Header</h6>\n              <div class="row">\n                <div class="col-md-6">\n                  <div class="mb-3">\n                    <label class="form-label">Customer Number *</label>\n                    <input type="text" class="form-control" id="custNum" value="').concat(l.custNum,'" readonly>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">Customer Name</label>\n                    <input type="text" class="form-control" id="customerName" value="').concat(l.customerName||"",'" readonly>\n                    <small class="form-text text-muted">Extracted from bill-to address</small>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">PO Number *</label>\n                    <input type="text" class="form-control" id="poNum" value="').concat(l.poNum,'" readonly>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">Order Date</label>\n                    <input type="datetime-local" class="form-control" id="orderDate" value="').concat(l.orderDate,'" readonly>\n                  </div>\n                </div>\n                <div class="col-md-6">\n                  <div class="mb-3">\n                    <label class="form-label">Ship Via Code</label>\n                    <select class="form-select" id="shipViaCode" disabled>\n                      <option value="INVO" ').concat("INVO"===l.shipViaCode?"selected":"",'>INVO</option>\n                      <option value="UPS" ').concat("UPS"===l.shipViaCode?"selected":"",'>UPS</option>\n                      <option value="FEDEX" ').concat("FEDEX"===l.shipViaCode?"selected":"",'>FEDEX</option>\n                      <option value="TRUCK" ').concat("TRUCK"===l.shipViaCode?"selected":"",'>TRUCK</option>\n                    </select>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">Payment Flag</label>\n                    <select class="form-select" id="payFlag" disabled>\n                      <option value="SHIP" ').concat("SHIP"===l.payFlag?"selected":"",'>SHIP</option>\n                      <option value="PREPAID" ').concat("PREPAID"===l.payFlag?"selected":"",'>PREPAID</option>\n                      <option value="COD" ').concat("COD"===l.payFlag?"selected":"",'>COD</option>\n                    </select>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">Shipping Method</label>\n                    <select class="form-select" id="shippingMethod" disabled>\n                      <option value="GROUND" ').concat("GROUND"===l.shippingMethod?"selected":"",'>Ground</option>\n                      <option value="2ND_DAY_AIR" ').concat("2ND_DAY_AIR"===l.shippingMethod?"selected":"",'>2nd Day Air</option>\n                      <option value="NEXT_DAY_AIR" ').concat("NEXT_DAY_AIR"===l.shippingMethod?"selected":"",'>Next Day Air</option>\n                    </select>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">Shipping Account Number</label>\n                    <input type="text" class="form-control" id="shippingAccountNumber" value="').concat(l.shippingAccountNumber,'" readonly>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            \x3c!-- One-Time Ship Address Section --\x3e\n            <div class="mb-4">\n              <h6 class="border-bottom pb-2"><i class="fas fa-map-marker-alt"></i> One-Time Ship Address</h6>\n              <div class="form-check mb-3">\n                <input class="form-check-input" type="checkbox" id="useOTS" ').concat(l.useOTS?"checked":"",' disabled>\n                <label class="form-check-label" for="useOTS">Use One-Time Ship Address</label>\n              </div>\n              <div class="row">\n                <div class="col-md-6">\n                  <div class="mb-3">\n                    <label class="form-label">Company Name *</label>\n                    <input type="text" class="form-control" id="otsName" value="').concat(l.otsName,'" readonly>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">Address Line 1 *</label>\n                    <input type="text" class="form-control" id="otsAddress1" value="').concat(l.otsAddress1,'" readonly>\n                  </div>\n                </div>\n                <div class="col-md-6">\n                  <div class="mb-3">\n                    <label class="form-label">City *</label>\n                    <input type="text" class="form-control" id="otsCity" value="').concat(l.otsCity,'" readonly>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">State *</label>\n                    <select class="form-select" id="otsState" disabled>\n                      <option value="">Select State</option>\n                      <option value="AL">AL</option><option value="AK">AK</option><option value="AZ">AZ</option>\n                      <option value="AR">AR</option><option value="CA">CA</option><option value="CO">CO</option>\n                      <option value="CT">CT</option><option value="DE">DE</option><option value="FL">FL</option>\n                      <option value="GA">GA</option><option value="HI">HI</option><option value="ID">ID</option>\n                      <option value="IL">IL</option><option value="IN">IN</option><option value="IA">IA</option>\n                      <option value="KS">KS</option><option value="KY">KY</option><option value="LA">LA</option>\n                      <option value="ME">ME</option><option value="MD">MD</option><option value="MA">MA</option>\n                      <option value="MI">MI</option><option value="MN">MN</option><option value="MS">MS</option>\n                      <option value="MO">MO</option><option value="MT">MT</option><option value="NE">NE</option>\n                      <option value="NV">NV</option><option value="NH">NH</option><option value="NJ">NJ</option>\n                      <option value="NM">NM</option><option value="NY">NY</option><option value="NC">NC</option>\n                      <option value="ND">ND</option><option value="OH">OH</option><option value="OK">OK</option>\n                      <option value="OR">OR</option><option value="PA">PA</option><option value="RI">RI</option>\n                      <option value="SC">SC</option><option value="SD">SD</option><option value="TN">TN</option>\n                      <option value="TX">TX</option><option value="UT">UT</option><option value="VT">VT</option>\n                      <option value="VA">VA</option><option value="WA">WA</option><option value="WV">WV</option>\n                      <option value="WI">WI</option><option value="WY">WY</option>\n                    </select>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">ZIP Code *</label>\n                    <input type="text" class="form-control" id="otsZip" value="').concat(l.otsZip,'" readonly>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            \x3c!-- Line Items Section --\x3e\n            <div class="mb-4">\n              <h6 class="border-bottom pb-2"><i class="fas fa-list"></i> Line Items</h6>\n              <div id="lineItemsContainer">\n                ').concat(h(l.lineItems),'\n              </div>\n            </div>\n\n            \x3c!-- Read-only notice --\x3e\n            <div class="alert alert-info">\n              <i class="fas fa-info-circle"></i> This order has been entered and cannot be modified.\n            </div>\n          </div>\n        </div>\n      </div>\n    '),(s=document.getElementById("otsState"))&&(s.value=l.otsState));case 2:return e.a(2)}},n)}))).apply(this,arguments)}function h(e){return e&&0!==e.length?e.map(function(e,n){return'\n    <div class="line-item-card mb-3 p-3 border rounded" data-index="'.concat(n,'">\n      <div class="row">\n        <div class="col-md-6">\n          <div class="mb-3">\n            <label class="form-label">Part Number *</label>\n            <input type="text" class="form-control" id="partNum_').concat(n,'" value="').concat(e.internal_part_number||"",'" readonly>\n          </div>\n          <div class="mb-3">\n            <label class="form-label">Description</label>\n            <input type="text" class="form-control" id="lineDesc_').concat(n,'" value="').concat(e.description||"",'" readonly>\n          </div>\n        </div>\n        <div class="col-md-6">\n          <div class="mb-3">\n            <label class="form-label">Quantity *</label>\n            <input type="number" class="form-control" id="sellingQuantity_').concat(n,'" value="').concat(e.quantity||"",'" readonly>\n          </div>\n          <div class="mb-3">\n            <label class="form-label">Unit Price *</label>\n            <input type="number" class="form-control" id="docUnitPrice_').concat(n,'" value="').concat(e.unit_price||"",'" readonly>\n          </div>\n        </div>\n      </div>\n      <div class="row">\n        <div class="col-12">\n          <small class="text-muted">\n            <strong>External Part:</strong> ').concat(e.external_part_number||"N/A",' | \n            <strong>Status:</strong> <span class="badge bg-success">Approved</span> | \n            <strong>Confidence:</strong> ').concat((e.mapping_confidence||0).toFixed(1),"%\n          </small>\n        </div>\n      </div>\n    </div>\n  ")}).join(""):'<p class="text-muted">No line items found</p>'}function _(e){window.showError=_;var n=document.querySelector(".card-body");n&&(n.innerHTML='\n      <div class="alert alert-danger">\n        <h5><i class="fas fa-exclamation-triangle"></i> Error</h5>\n        <p>'.concat(e,"</p>\n      </div>\n    "))}function N(e,n,t){return S.apply(this,arguments)}function S(){return(S=o(e().m(function n(t,o,i){var l,r,c;return e().w(function(e){for(;;)switch(e.n){case 0:return a=t,e.n=1,E(t);case 1:l=e.v,(r=document.querySelector(".card-body"))&&(r.innerHTML='\n      <div id="formView">\n        <div class="card" id="epicorFormCard">\n          <div class="card-header">\n            <h5 class="mb-0"><i class="fas fa-file-invoice"></i> Epicor Order Form</h5>\n          </div>\n          <div class="card-body">\n            \x3c!-- Order Header Section --\x3e\n            <div class="mb-4">\n              <h6 class="border-bottom pb-2"><i class="fas fa-heading"></i> Order Header</h6>\n              <div class="row">\n                <div class="col-md-6">\n                  <div class="mb-3">\n                    <label class="form-label">Customer Number *</label>\n                    <input type="text" class="form-control" id="custNum" value="'.concat(l.custNum,'" required>\n                    <div class="field-error" id="custNum_error" style="display: none;"></div>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">Customer Name</label>\n                    <input type="text" class="form-control" id="customerName" value="').concat(l.customerName||"",'" readonly>\n                    <small class="form-text text-muted">Extracted from bill-to address</small>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">PO Number *</label>\n                    <input type="text" class="form-control" id="poNum" value="').concat(l.poNum,'" required>\n                    <div class="field-error" id="poNum_error" style="display: none;"></div>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">Order Date</label>\n                    <input type="datetime-local" class="form-control" id="orderDate" value="').concat(l.orderDate,'">\n                  </div>\n                </div>\n                <div class="col-md-6">\n                  <div class="mb-3">\n                    <label class="form-label">Ship Via Code</label>\n                    <select class="form-select" id="shipViaCode">\n                      <option value="INVO" ').concat("INVO"===l.shipViaCode?"selected":"",'>INVO</option>\n                      <option value="UPS" ').concat("UPS"===l.shipViaCode?"selected":"",'>UPS</option>\n                      <option value="FEDEX" ').concat("FEDEX"===l.shipViaCode?"selected":"",'>FEDEX</option>\n                      <option value="TRUCK" ').concat("TRUCK"===l.shipViaCode?"selected":"",'>TRUCK</option>\n                    </select>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">Payment Flag</label>\n                    <select class="form-select" id="payFlag">\n                      <option value="SHIP" ').concat("SHIP"===l.payFlag?"selected":"",'>SHIP</option>\n                      <option value="PREPAID" ').concat("PREPAID"===l.payFlag?"selected":"",'>PREPAID</option>\n                      <option value="COD" ').concat("COD"===l.payFlag?"selected":"",'>COD</option>\n                    </select>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">Shipping Method</label>\n                    <select class="form-select" id="shippingMethod">\n                      <option value="GROUND" ').concat("GROUND"===l.shippingMethod?"selected":"",'>Ground</option>\n                      <option value="2ND_DAY_AIR" ').concat("2ND_DAY_AIR"===l.shippingMethod?"selected":"",'>2nd Day Air</option>\n                      <option value="NEXT_DAY_AIR" ').concat("NEXT_DAY_AIR"===l.shippingMethod?"selected":"",'>Next Day Air</option>\n                    </select>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">Shipping Account Number</label>\n                    <input type="text" class="form-control" id="shippingAccountNumber" value="').concat(l.shippingAccountNumber,'">\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            \x3c!-- One-Time Ship Address Section --\x3e\n            <div class="mb-4">\n              <h6 class="border-bottom pb-2"><i class="fas fa-map-marker-alt"></i> One-Time Ship Address</h6>\n              <div class="form-check mb-3">\n                <input class="form-check-input" type="checkbox" id="useOTS" ').concat(l.useOTS?"checked":"",'>\n                <label class="form-check-label" for="useOTS">Use One-Time Ship Address</label>\n              </div>\n              <div class="row">\n                <div class="col-md-6">\n                  <div class="mb-3">\n                    <label class="form-label">Company Name *</label>\n                    <input type="text" class="form-control" id="otsName" value="').concat(l.otsName,'" required>\n                    <div class="field-error" id="otsName_error" style="display: none;"></div>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">Address Line 1 *</label>\n                    <input type="text" class="form-control" id="otsAddress1" value="').concat(l.otsAddress1,'" required>\n                    <div class="field-error" id="otsAddress1_error" style="display: none;"></div>\n                  </div>\n                </div>\n                <div class="col-md-6">\n                  <div class="mb-3">\n                    <label class="form-label">City *</label>\n                    <input type="text" class="form-control" id="otsCity" value="').concat(l.otsCity,'" required>\n                    <div class="field-error" id="otsCity_error" style="display: none;"></div>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">State *</label>\n                    <select class="form-select" id="otsState" required>\n                      <option value="">Select State</option>\n                      <option value="AL">AL</option><option value="AK">AK</option><option value="AZ">AZ</option>\n                      <option value="AR">AR</option><option value="CA">CA</option><option value="CO">CO</option>\n                      <option value="CT">CT</option><option value="DE">DE</option><option value="FL">FL</option>\n                      <option value="GA">GA</option><option value="HI">HI</option><option value="ID">ID</option>\n                      <option value="IL">IL</option><option value="IN">IN</option><option value="IA">IA</option>\n                      <option value="KS">KS</option><option value="KY">KY</option><option value="LA">LA</option>\n                      <option value="ME">ME</option><option value="MD">MD</option><option value="MA">MA</option>\n                      <option value="MI">MI</option><option value="MN">MN</option><option value="MS">MS</option>\n                      <option value="MO">MO</option><option value="MT">MT</option><option value="NE">NE</option>\n                      <option value="NV">NV</option><option value="NH">NH</option><option value="NJ">NJ</option>\n                      <option value="NM">NM</option><option value="NY">NY</option><option value="NC">NC</option>\n                      <option value="ND">ND</option><option value="OH">OH</option><option value="OK">OK</option>\n                      <option value="OR">OR</option><option value="PA">PA</option><option value="RI">RI</option>\n                      <option value="SC">SC</option><option value="SD">SD</option><option value="TN">TN</option>\n                      <option value="TX">TX</option><option value="UT">UT</option><option value="VT">VT</option>\n                      <option value="VA">VA</option><option value="WA">WA</option><option value="WV">WV</option>\n                      <option value="WI">WI</option><option value="WY">WY</option>\n                    </select>\n                    <div class="field-error" id="otsState_error" style="display: none;"></div>\n                  </div>\n                  <div class="mb-3">\n                    <label class="form-label">ZIP Code *</label>\n                    <input type="text" class="form-control" id="otsZip" value="').concat(l.otsZip,'" required>\n                    <div class="field-error" id="otsZip_error" style="display: none;"></div>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            \x3c!-- Line Items Section --\x3e\n            <div class="mb-4">\n              <div class="d-flex justify-content-between align-items-center mb-3">\n                <h6 class="mb-0 border-bottom pb-2"><i class="fas fa-list"></i> Line Items</h6>\n                <button type="button" class="btn btn-sm btn-outline-primary" id="addLineItem">\n                  <i class="fas fa-plus"></i> Add Item\n        </button>\n      </div>\n              <div id="lineItemsContainer">\n                ').concat(T(l.lineItems),'\n    </div>\n            </div>\n\n            \x3c!-- Action Buttons --\x3e\n            <div class="d-flex gap-2">\n              <button type="button" class="btn btn-primary" id="saveFormBtn">\n                <i class="fas fa-save"></i> Save & Enter Order\n              </button>\n              <button type="button" class="btn btn-outline-secondary" id="resetFormBtn">\n                <i class="fas fa-undo"></i> Reset\n        </button>\n      </div>\n    </div>\n      </div>\n    </div>\n  '),R(),(c=document.getElementById("otsState"))&&(c.value=l.otsState),setTimeout(function(){F()},100));case 2:return e.a(2)}},n)}))).apply(this,arguments)}function I(){return(I=o(e().m(function n(t){var o,a,l,r,c,s;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,o=Office.context.mailbox.item.itemId,a=Office.context.mailbox.item.subject,l=i?"attachment_".concat(i):"unknown",e.n=1,fetch("http://127.0.0.1:5000/api/save_updated_data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email_id:o,subject:a,attachment_name:l,updated_data:t})});case 1:if((r=e.v).ok){e.n=2;break}throw new Error("HTTP error! status: ".concat(r.status));case 2:return e.n=3,r.json();case 3:c=e.v,console.log("Data saved to server:",c),e.n=5;break;case 4:e.p=4,s=e.v,console.error("Error saving updated data to server:",s);case 5:return e.a(2)}},n,null,[[0,4]])}))).apply(this,arguments)}function A(e){return O.apply(this,arguments)}function O(){return(O=o(e().m(function n(t){var o,a,i;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,fetch("http://localhost:5000/api/get_customer_by_account?account_number=".concat(encodeURIComponent(t)));case 1:return o=e.v,e.n=2,o.json();case 2:if(!(a=e.v).success||!a.customer){e.n=3;break}return e.a(2,a.customer.company_name);case 3:return e.a(2,"");case 4:return e.p=4,i=e.v,console.error("Error looking up customer:",i),e.a(2,"")}},n,null,[[0,4]])}))).apply(this,arguments)}function E(e){return x.apply(this,arguments)}function x(){return(x=o(e().m(function n(t){var o,a,i,l,r,c,s,d,u,p,m,v,f,b,y,g,h,_,N,S;return e().w(function(e){for(;;)switch(e.n){case 0:if(!(t.ds&&t.ds.OrderHed&&t.ds.OrderHed.length>0)){e.n=2;break}return u=t.ds.OrderHed[0],p=t.ds.OrderDtl||[],e.n=1,A(u.CustNum||"");case 1:return m=e.v,e.a(2,{custNum:u.CustNum||"",poNum:u.PONum||"",customerName:m,orderDate:u.OrderDate?new Date(u.OrderDate).toISOString().slice(0,16):(new Date).toISOString().slice(0,16),shipViaCode:u.ShipViaCode||"INVO",payFlag:u.PayFlag||"SHIP",shippingMethod:"2ND_DAY_AIR"===u.ShippingMethod?"2ND_DAY_AIR":"NEXT_DAY_AIR"===u.ShippingMethod?"NEXT_DAY_AIR":"GROUND",shippingAccountNumber:u.ShippingAccountNumber||"prepaid & add",useOTS:u.UseOTS||!1,otsName:u.OTSName||"",otsAddress1:u.OTSAddress1||"",otsCity:u.OTSCity||"",otsState:u.OTSState||"",otsZip:u.OTSZip||"",lineItems:p.map(function(e){return{internal_part_number:e.PartNum||"",description:e.LineDesc||"",quantity:e.SellingQuantity||"",unit_price:e.DocUnitPrice||"",external_part_number:e.PartNum||"",mapping_status:"mapped",mapping_confidence:95}})});case 2:return v=(null===(o=t.company_info)||void 0===o?void 0:o.account_number)||"",f=(null===(a=t.company_info)||void 0===a?void 0:a.customer_po_number)||"",e.n=3,A((null===(i=t.company_info)||void 0===i?void 0:i.account_number)||"");case 3:return b=e.v,y=null!==(l=t.company_info)&&void 0!==l&&l.po_date?new Date(t.company_info.po_date).toISOString().slice(0,16):(new Date).toISOString().slice(0,16),g=(null===(r=t.company_info)||void 0===r?void 0:r.shipping_method)||"GROUND",h=(null===(c=t.company_info)||void 0===c?void 0:c.shipping_account_number)||"prepaid & add",_=(null===(s=t.company_info)||void 0===s?void 0:s.company_name)||"",N=(null===(d=t.company_info)||void 0===d?void 0:d.shipping_address)||"",S=t.line_items||[],e.a(2,{custNum:v,poNum:f,customerName:b,orderDate:y,shipViaCode:"INVO",payFlag:"SHIP",shippingMethod:g,shippingAccountNumber:h,useOTS:!0,otsName:_,otsAddress1:N,otsCity:"",otsState:"",otsZip:"",lineItems:S})}},n)}))).apply(this,arguments)}function T(e){return e&&0!==e.length?e.map(function(e,n){return'\n    <div class="line-item-card mb-3 p-3 border rounded" data-index="'.concat(n,'">\n      <div class="position-absolute top-0 end-0">\n        <button type="button" class="btn btn-sm btn-outline-danger" onclick="removeLineItem(').concat(n,')">\n          <i class="fas fa-times"></i>\n          </button>\n        </div>\n        <div class="row">\n          <div class="col-md-6">\n          <div class="mb-3">\n            <label class="form-label">Part Number *</label>\n            <input type="text" class="form-control" id="partNum_').concat(n,'" value="').concat(e.internal_part_number||"",'" placeholder="Enter part number" required>\n            <div class="field-error" id="partNum_error_').concat(n,'" style="display: none;"></div>\n          </div>\n          <div class="mb-3">\n            <label class="form-label">Description</label>\n            <input type="text" class="form-control" id="lineDesc_').concat(n,'" value="').concat(e.description||"",'" placeholder="Enter description">\n          </div>\n        </div>\n        <div class="col-md-6">\n          <div class="mb-3">\n            <label class="form-label">Quantity *</label>\n            <input type="number" class="form-control" id="sellingQuantity_').concat(n,'" value="').concat(e.quantity||"",'" placeholder="Enter quantity" required>\n            <div class="field-error" id="sellingQuantity_error_').concat(n,'" style="display: none;"></div>\n      </div>\n          <div class="mb-3">\n            <label class="form-label">Unit Price *</label>\n            <input type="number" class="form-control" id="docUnitPrice_').concat(n,'" value="').concat(e.unit_price||"",'" step="0.01" placeholder="Enter unit price" required>\n            <div class="field-error" id="docUnitPrice_error_').concat(n,'" style="display: none;"></div>\n            </div>\n              </div>\n            </div>\n      <div class="row">\n        <div class="col-12">\n          <small class="text-muted">\n            <strong>External Part:</strong> ').concat(e.external_part_number||"N/A",' | \n            <strong>Status:</strong> <span class="badge bg-').concat("mapped"===e.mapping_status?"success":"warning",'">').concat(e.mapping_status||"Unknown","</span> | \n            <strong>Confidence:</strong> ").concat((e.mapping_confidence||0).toFixed(1),"%\n          </small>\n          </div>\n        </div>\n      </div>\n  ")}).join(""):'<p class="text-muted">No line items found</p>'}function D(){console.log("Arzana: Background processing initialized")}function C(){return w.apply(this,arguments)}function w(){return(w=o(e().m(function n(){return e().w(function(e){for(;;)if(0===e.n)return e.a(2,Promise.resolve())},n)}))).apply(this,arguments)}function P(){return k.apply(this,arguments)}function k(){return(k=o(e().m(function n(){return e().w(function(e){for(;;)if(0===e.n)return e.a(2,Promise.resolve())},n)}))).apply(this,arguments)}function R(){var e=document.getElementById("addLineItem");null==e||e.addEventListener("click",M);var n=document.getElementById("saveFormBtn");null==n||n.addEventListener("click",L);var t=document.getElementById("resetFormBtn");null==t||t.addEventListener("click",U),document.querySelectorAll("#formView input, #formView select").forEach(function(e){e.addEventListener("blur",V),e.addEventListener("input",function(e){!function(e){var n=e.target;n.classList.remove("is-invalid");var t=n.id+"_error",o=document.getElementById(t);o&&(o.style.display="none")}(e),F()})})}function M(){var e=document.getElementById("lineItemsContainer");if(e){var n,t,o=e.children.length,a=(n={internal_part_number:"",description:"",quantity:"",unit_price:"",external_part_number:"",mapping_status:"manual",mapping_confidence:0},'\n    <div class="line-item-card mb-3 p-3 border rounded" data-index="'.concat(t=o,'">\n      <div class="position-absolute top-0 end-0">\n        <button type="button" class="btn btn-sm btn-outline-danger" onclick="removeLineItem(').concat(t,')">\n          <i class="fas fa-times"></i>\n        </button>\n      </div>\n        <div class="row">\n          <div class="col-md-6">\n          <div class="mb-3">\n            <label class="form-label">Part Number *</label>\n            <input type="text" class="form-control" id="partNum_').concat(t,'" value="').concat(n.internal_part_number||"",'" placeholder="Enter part number" required>\n            <div class="field-error" id="partNum_error_').concat(t,'" style="display: none;"></div>\n          </div>\n          <div class="mb-3">\n            <label class="form-label">Description</label>\n            <input type="text" class="form-control" id="lineDesc_').concat(t,'" value="').concat(n.description||"",'" placeholder="Enter description">\n          </div>\n        </div>\n        <div class="col-md-6">\n          <div class="mb-3">\n            <label class="form-label">Quantity *</label>\n            <input type="number" class="form-control" id="sellingQuantity_').concat(t,'" value="').concat(n.quantity||"",'" placeholder="Enter quantity" required>\n            <div class="field-error" id="sellingQuantity_error_').concat(t,'" style="display: none;"></div>\n      </div>\n          <div class="mb-3">\n            <label class="form-label">Unit Price *</label>\n            <input type="number" class="form-control" id="docUnitPrice_').concat(t,'" value="').concat(n.unit_price||"",'" step="0.01" placeholder="Enter unit price" required>\n            <div class="field-error" id="docUnitPrice_error_').concat(t,'" style="display: none;"></div>\n            </div>\n              </div>\n            </div>\n      <div class="row">\n        <div class="col-12">\n          <small class="text-muted">\n            <strong>External Part:</strong> ').concat(n.external_part_number||"N/A",' | \n            <strong>Status:</strong> <span class="badge bg-').concat("mapped"===n.mapping_status?"success":"warning",'">').concat(n.mapping_status||"Unknown","</span> | \n            <strong>Confidence:</strong> ").concat((n.mapping_confidence||0).toFixed(1),"%\n          </small>\n        </div>\n      </div>\n    </div>\n  "));e.insertAdjacentHTML("beforeend",a);var i=e.lastElementChild;i&&i.querySelectorAll("input").forEach(function(e){e.addEventListener("blur",function(){return H(o)}),e.addEventListener("input",function(){return function(e){["partNum_".concat(e),"sellingQuantity_".concat(e),"docUnitPrice_".concat(e)].forEach(function(e){var n=document.getElementById(e);if(n){n.classList.remove("is-invalid");var t=document.getElementById(e+"_error");t&&(t.style.display="none")}})}(o)})})}}function L(){if(F()){var e,n,t,o,i,l,r,c,s,d,u,p,m,v,f,b,y,g,h,N,S,A,O,E,x,T,D,C=(v=(null===(e=document.getElementById("custNum"))||void 0===e?void 0:e.value)||"",f=(null===(n=document.getElementById("poNum"))||void 0===n?void 0:n.value)||"",b=(null===(t=document.getElementById("orderDate"))||void 0===t?void 0:t.value)||(new Date).toISOString().slice(0,16),y=(null===(o=document.getElementById("shipViaCode"))||void 0===o?void 0:o.value)||"INVO",g=(null===(i=document.getElementById("payFlag"))||void 0===i?void 0:i.value)||"SHIP",h=(null===(l=document.getElementById("shippingMethod"))||void 0===l?void 0:l.value)||"GROUND",N=(null===(r=document.getElementById("shippingAccountNumber"))||void 0===r?void 0:r.value)||"prepaid & add",S=(null===(c=document.getElementById("useOTS"))||void 0===c?void 0:c.checked)||!1,A=(null===(s=document.getElementById("otsName"))||void 0===s?void 0:s.value)||"",O=(null===(d=document.getElementById("otsAddress1"))||void 0===d?void 0:d.value)||"",E=(null===(u=document.getElementById("otsCity"))||void 0===u?void 0:u.value)||"",x=(null===(p=document.getElementById("otsState"))||void 0===p?void 0:p.value)||"",T=(null===(m=document.getElementById("otsZip"))||void 0===m?void 0:m.value)||"",D=[],document.querySelectorAll(".line-item-card").forEach(function(e,n){var t,o,a,i,l=(null===(t=document.getElementById("partNum_".concat(n)))||void 0===t?void 0:t.value)||"",r=(null===(o=document.getElementById("lineDesc_".concat(n)))||void 0===o?void 0:o.value)||"",c=(null===(a=document.getElementById("sellingQuantity_".concat(n)))||void 0===a?void 0:a.value)||"",s=(null===(i=document.getElementById("docUnitPrice_".concat(n)))||void 0===i?void 0:i.value)||"";(l||c||s)&&D.push({PartNum:l,LineDesc:r,SellingQuantity:parseFloat(c)||0,DocUnitPrice:parseFloat(s)||0})}),{ds:{OrderHed:[{CustNum:v,PONum:f,OrderDate:b,ShipViaCode:y,PayFlag:g,ShippingMethod:h,ShippingAccountNumber:N,UseOTS:S,OTSName:A,OTSAddress1:O,OTSCity:E,OTSState:x,OTSZip:T}],OrderDtl:D}});console.log("Saving updated form data:",C),a=C,function(e){I.apply(this,arguments)}(C);try{console.log("Starting tag update process..."),Office.context.mailbox.item.categories.getAsync(function(e){if(console.log("Current categories:",e),e.status===Office.AsyncResultStatus.Succeeded){var n=e.value;console.log("Current category names:",n.map(function(e){return e.displayName}));var t=n.filter(function(e){return["Pending Approval","Missing Info","Approved"].includes(e.displayName)}).map(function(e){return e.displayName});console.log("Tags to remove:",t),t.length>0?Office.context.mailbox.item.categories.removeAsync(t,function(e){console.log("Remove result:",e),Office.context.mailbox.item.categories.addAsync(["Approved"],function(e){var n;console.log("Add result:",e),e.status===Office.AsyncResultStatus.Succeeded?(G('Order entered successfully! Email tagged as "Approved"'),K()):(console.error("Add tag failed:",e.error),G("Order entered successfully! (Tag update failed: "+((null===(n=e.error)||void 0===n?void 0:n.message)||"Unknown error")+")"),K())})}):Office.context.mailbox.item.categories.addAsync(["Approved"],function(e){var n;console.log("Add result (no removal):",e),e.status===Office.AsyncResultStatus.Succeeded?(G('Order entered successfully! Email tagged as "Approved"'),K()):(console.error("Add tag failed:",e.error),G("Order entered successfully! (Tag update failed: "+((null===(n=e.error)||void 0===n?void 0:n.message)||"Unknown error")+")"),K())})}else console.error("Failed to get current categories:",e.error),G("Order entered successfully! (Could not read current tags)")})}catch(e){console.error("Error updating email tags:",e),G("Order entered successfully! (Tag update failed: "+e.message+")")}}else _('Please complete all required fields and remove any "MISSING" values before saving.')}function U(){confirm("Are you sure you want to reset the form? All changes will be lost.")&&N(a,null,null).catch(console.error)}function F(){var e=!0;[{id:"custNum",name:"Customer Number"},{id:"poNum",name:"PO Number"},{id:"otsName",name:"Company Name"},{id:"otsAddress1",name:"Address Line 1"},{id:"otsCity",name:"City"},{id:"otsState",name:"State"},{id:"otsZip",name:"ZIP Code"}].forEach(function(n){var t=document.getElementById(n.id);if(t){var o=t.value.trim(),a=o&&""!==o,i=o.toUpperCase().includes("MISSING");!a||i?(B(t,"".concat(n.name,i?' contains "MISSING" and needs to be filled':" is required")),e=!1):q(t)}}),document.querySelectorAll(".line-item-card").forEach(function(n,t){H(t)||(e=!1)});var n=document.getElementById("saveFormBtn");return n&&(n.disabled=!e,e?(n.innerHTML='<i class="fas fa-save"></i> Save & Enter Order',n.className="btn btn-primary"):(n.innerHTML='<i class="fas fa-exclamation-triangle"></i> Complete Required Fields',n.className="btn btn-warning")),e}function V(e){var n=e.target,t=n.value.trim();n.required&&!t?B(n,"This field is required"):"MISSING"===t||t.includes("MISSING")?B(n,'This field contains "MISSING" and needs to be filled'):q(n)}function H(e){var n=!0;return[{id:"partNum_".concat(e),name:"Part Number"},{id:"sellingQuantity_".concat(e),name:"Quantity"},{id:"docUnitPrice_".concat(e),name:"Unit Price"}].forEach(function(e){var t=document.getElementById(e.id);if(t){var o=t.value.trim(),a=o&&""!==o,i=o.toUpperCase().includes("MISSING");!a||i?(B(t,"".concat(e.name,i?' contains "MISSING" and needs to be filled':" is required")),n=!1):q(t)}}),n}function B(e,n){e.classList.remove("is-valid"),e.classList.add("is-invalid");var t=e.id+"_error",o=document.getElementById(t);o&&(o.textContent=n,o.style.display="block")}function q(e){e.classList.remove("is-invalid"),e.classList.add("is-valid");var n=e.id+"_error",t=document.getElementById(n);t&&(t.style.display="none")}function G(e){var n=document.createElement("div");n.className="alert alert-success alert-dismissible fade show position-fixed",n.style.cssText="top: 10px; right: 10px; z-index: 9999; min-width: 300px;",n.innerHTML="".concat(e,'<button type="button" class="btn-close" onclick="this.parentElement.remove()"></button>'),document.body.appendChild(n),setTimeout(function(){return n.remove()},3e3)}function j(e){var n,t,o=((null===(n=Office.context.mailbox.item.from)||void 0===n?void 0:n.displayName)||(null===(t=Office.context.mailbox.item.from)||void 0===t?void 0:t.emailAddress)||"Customer").split(" ")[0]||"Customer",a=0,i=e.lineItems.map(function(e){var n=(parseFloat(e.quantity)||0)*(parseFloat(e.unit_price)||0);return a+=n,"â€¢ ".concat(e.internal_part_number,": ").concat(e.quantity," @ $").concat(parseFloat(e.unit_price).toFixed(2)," = $").concat(n.toFixed(2))}).join("\n"),l=new Date;l.setDate(l.getDate()+3);var r=l.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});return"Hi ".concat(o,",\n\nPO").concat(e.poNum," processed successfully.\n\nAccount: ").concat(e.custNum,"\nParts:\n").concat(i,"\n\nTotal: $").concat(a.toFixed(2),"\nDelivery: ").concat(r,"\n\nThanks,\nWilliam")}function K(){return Z.apply(this,arguments)}function Z(){return(Z=o(e().m(function n(){var t,o,i,l;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,E(a);case 1:o=e.v,i=j(o),Office.context.mailbox.displayNewMessageForm({toRecipients:[(null===(t=Office.context.mailbox.item.from)||void 0===t?void 0:t.emailAddress)||""],subject:"Order Acknowledgement - PO".concat(o.poNum),body:i,attachments:[]}),G("Order acknowledgement draft opened! Review and send when ready."),e.n=3;break;case 2:e.p=2,l=e.v,console.error("Error creating order acknowledgement draft:",l),_("Failed to create order acknowledgement draft: "+l.message);case 3:return e.a(2)}},n,null,[[0,2]])}))).apply(this,arguments)}function Y(){try{K(),G("Acknowledgement draft opened! Review and send when ready.")}catch(e){console.error("Error opening acknowledgement email:",e),_("Failed to open acknowledgement email: "+e.message)}}new Set}();
//# sourceMappingURL=taskpane.js.map